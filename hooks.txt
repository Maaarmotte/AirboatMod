hook.Add("PlayerSay", "Airboat", function(ply, text, isTeam)
	if text == "!boat" then
		AMMain.InitPlayer(ply)
	end
end)

hook.Add("Tick", "Airboat", AMMain.Tick)

hook.Add("CanPlayerEnterVehicle", "Airboat", function(ply, boat)
	local amPlayer = ply.AMPlayer
	local amBoat = boat.AMBoat
	
	if amBoat and amBoat:GetEntity():IsValid() and amPlayer and amPlayer:GetEntity():IsValid() then
		if amPlayer:GetPlaying() then
			return true
		end
		AMMenu.SendMenu(amPlayer, amBoat)
		return false
	end
end)

hook.Add("PlayerLeaveVehicle", "Airboat", function(ply, boat)
	local amPlayer = ply.AMPlayer
	if amPlayer then
		amPlayer:SetPlaying(false)
	end
end)

concommand.Add("am_play", function(ply)
	local amPlayer = ply.AMPlayer
	if not amPlayer then return end
	
	local amBoat = amPlayer:GetAirboat()
	if not amBoat or not amBoat:GetEntity() or not amBoat:GetEntity():IsValid() then return end

	amPlayer:SetPlaying(true)
	ply:EnterVehicle(amBoat:GetEntity())
end)